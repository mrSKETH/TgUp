import telebot
from telebot import types

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç–µ —É @BotFather)
TOKEN = "8188317423:AAErG71gKMEf-EdLSjFXwjCvFblCOguLKpM"

bot = telebot.TeleBot(TOKEN)

# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏
PROXIES = {
    "proxy1": {
        "name": "üåê General",
        "url": "https://t.me/proxy?server=185.130.115.156&port=443&secret=dd6b3fb02424dbac55fef2da67c8c949",
        "desc": "–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä"
    },
    "proxy2": {
        "name": "‚ö° Alt 1", 
        "url": "https://t.me/proxy?server=146.185.208.135&port=443&secret=dd6b3fb02424dbac55fef2da67c8c949",
        "desc": "1 –ó–∞–ø–∞—Å–Ω–æ–π"
    },
    "proxy3": {
        "name": "üá™üá∫ Fast",
        "url": "https://t.me/proxy?server=www.download-fast.co.uk&port=443&secret=dd10dadd1e7c27a20098abb5bf53ca26a8",
        "desc": "–° –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –ø–∏–Ω–≥–æ–º"
    }
}

# –ö–æ–º–∞–Ω–¥–∞ /start
@bot.message_handler(commands=['start'])
def start(message):
    show_main_menu(message.chat.id)

# –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
def show_main_menu(chat_id):
    markup = types.InlineKeyboardMarkup(row_width=1)
    
    btn_proxy = types.InlineKeyboardButton("üöÄ Proxy", callback_data="menu_proxy")
    btn_zapret = types.InlineKeyboardButton("üõë Zapret", callback_data="menu_zapret")
    btn_gui = types.InlineKeyboardButton("üé® GUIzapret", callback_data="menu_gui")
    
    markup.add(btn_proxy, btn_zapret, btn_gui)
    
    bot.send_message(
        chat_id,
        "üëã **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é!**\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Ä–∞–∑–¥–µ–ª–æ–≤:",
        reply_markup=markup,
        parse_mode="Markdown"
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫
@bot.callback_query_handler(func=lambda call: True)
def handle_callback(call):
    # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    if call.data == "menu_proxy":
        show_proxy_menu(call)
    
    elif call.data == "menu_zapret":
        bot.answer_callback_query(
            call.id,
            "‚è≥ –í –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –ø–æ—è–≤–∏—Ç—Å—è!",
            show_alert=False
        )
    
    elif call.data == "menu_gui":
        bot.answer_callback_query(
            call.id,
            "‚è≥ –í –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –ø–æ—è–≤–∏—Ç—Å—è!",
            show_alert=False
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"
    elif call.data == "back_to_menu":
        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text="üëã **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é!**\n\n"
                 "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Ä–∞–∑–¥–µ–ª–æ–≤:",
            reply_markup=get_main_menu_markup(),
            parse_mode="Markdown"
        )
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–∫—Å–∏
    elif call.data.startswith("proxy_"):
        proxy_id = call.data.replace("proxy_", "")
        
        if proxy_id in PROXIES:
            proxy = PROXIES[proxy_id]
            
            markup = types.InlineKeyboardMarkup()
            btn_connect = types.InlineKeyboardButton(
                text="üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è",
                url=proxy["url"]
            )
            btn_back = types.InlineKeyboardButton(
                text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                callback_data="back_to_proxy_list"
            )
            markup.add(btn_connect, btn_back)
            
            bot.edit_message_text(
                chat_id=call.message.chat.id,
                message_id=call.message.message_id,
                text=f"**{proxy['name']}**\n\n"
                     f"üìù *–û–ø–∏—Å–∞–Ω–∏–µ:* {proxy['desc']}\n\n"
                     f"–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:",
                reply_markup=markup,
                parse_mode="Markdown"
            )
    
    # –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –ø—Ä–æ–∫—Å–∏
    elif call.data == "back_to_proxy_list":
        show_proxy_menu(call)
    
    bot.answer_callback_query(call.id)

# –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é –ø—Ä–æ–∫—Å–∏
def show_proxy_menu(call):
    markup = types.InlineKeyboardMarkup(row_width=1)
    
    for proxy_id, proxy_data in PROXIES.items():
        btn = types.InlineKeyboardButton(
            text=proxy_data["name"],
            callback_data=f"proxy_{proxy_id}"
        )
        markup.add(btn)
    
    markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data="back_to_menu"))
    
    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text="üöÄ **–ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä—ã**\n\n"
             "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:",
        reply_markup=markup,
        parse_mode="Markdown"
    )

# –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
def get_main_menu_markup():
    markup = types.InlineKeyboardMarkup(row_width=1)
    
    btn_proxy = types.InlineKeyboardButton("üöÄ Proxy", callback_data="menu_proxy")
    btn_zapret = types.InlineKeyboardButton("üõë Zapret", callback_data="menu_zapret")
    btn_gui = types.InlineKeyboardButton("üé® GUIzapret", callback_data="menu_gui")
    
    markup.add(btn_proxy, btn_zapret, btn_gui)
    
    return markup

# –ö–æ–º–∞–Ω–¥–∞ /help
@bot.message_handler(commands=['help'])
def help_cmd(message):
    help_text = (
        "üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**\n"
        "/start - –æ—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é\n"
        "/help - –ø–æ–º–æ—â—å\n\n"
        "üëã **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ–¥–µ—Ä–∂–∏—Ç:**\n"
        "‚Ä¢ üöÄ Proxy - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–≤\n"
        "‚Ä¢ üõë Zapret - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ\n"
        "‚Ä¢ üé® GUIzapret - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ\n\n"
        "–ü—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ /start –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª!"
    )
    
    bot.send_message(
        message.chat.id,
        help_text,
        parse_mode="Markdown"
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª—é–±—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(func=lambda message: True)
def handle_text(message):
    if message.text not in ['/start', '/help']:
        bot.send_message(
            message.chat.id,
            "ü§î –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –∏–ª–∏ /help –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏."
        )

print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è!")
bot.polling(none_stop=True)
